!function(o){var t={ajax:"",html:"",targetblock:"",content:{header:"",content:"",footer:""},type:"standart",confirmcontent:{header:"Confirm your action",content:"Are you sure you want to continue?",buttonoktext:"Yes",buttonnotext:"Cancel"},width:"",height:"",submitformbutton:".submit-mobilepopup-form",popupform:".mobilepopup-form",closeonoverflowclick:!0,shakeonoverflowclick:!0,fullscreeninmobile:!0,closehtml:'<a href="" class="button-close close"></a>',loadinghtml:'<div class="loader-wrap"><div class="loader"><span></span><span></span><span></span></div></div>',customclass:"",onloaded:function(o){return!0},onclosed:function(o){return!0},onconfirmed:function(o){return!0},onformsubmited:function(o,t){return!0}},n=t,e="mobilepopup",i="mobilepopup-overflow",r="mobilepopup-outer",p="mobilepopup-inner",l=o(window),c=0,a=popupoverflow=popupouter=popupinner="",s={init:function(e){n=o.extend({},t,e),currenttopposition=o("body").scrollTop(),u(),m(),f(),a.addClass("open"),o("body").addClass("mobilepopup-opened"),d()},reload:function(t){"standart"==n.type&&""!=o.trim(n.targetblock)&&o(n.targetblock).html(popupinner.find(">*")),n=o.extend(n,t),a.attr("class",e+" "+n.customclass+" open loading"),m(),f(),d()},resize:function(t){n=o.extend(n,t),m()},close:function(){a.removeClass("open"),o("body").removeClass("mobilepopup-opened"),"standart"==n.type&&""!=o.trim(n.targetblock)?o(n.targetblock).html(popupinner.find(">*")):popupinner.html(""),n.onclosed(a)}},u=function(){0==o("."+e).length&&(o("body").append("<div class='"+e+" "+n.customclass+" loading'><div class='"+i+"'></div><div class='"+r+"'><div class='"+p+"'></div>"+n.closehtml+n.loadinghtml+"</div></div>"),a=o("."+e),popupoverflow=o("."+i),popupinner=o("."+p),popupouter=o("."+r),b())},d=function(){n.fullscreeninmobile?popupouter.removeClass("disable-mobile-fullscreen"):popupouter.addClass("disable-mobile-fullscreen")},m=function(){var t="";""!=o.trim(n.width)&&(t+="width:"+n.width+";"),""!=o.trim(n.height)&&(t+="height:"+n.height+";"),popupouter.attr("style",t),h()},f=function(){switch(n.type){case"standart":""!=o.trim(n.ajax)?o.post(n.ajax,function(o){popupinner.html(o),a.removeClass("loading"),n.onloaded(a)}):""!=o.trim(n.html)||""!=o.trim(n.targetblock)?(popupinner.html(""!=o.trim(n.html)?n.html:o(n.targetblock).find(">*")),a.removeClass("loading"),n.onloaded(a)):""==o.trim(n.content.content)&&""==o.trim(n.content.header)&&""==o.trim(n.content.footer)||(popupinner.html("<div class='header'>"+n.content.header+"</div><div class='content'>"+n.content.content+"</div><div class='footer'>"+n.content.footer+"</div>"),a.removeClass("loading"),n.onloaded(a));break;case"confirm":popupinner.html("<div class='header'>"+n.confirmcontent.header+"</div><div class='content'>"+n.confirmcontent.content+"</div><div class='footer'><a href='' class='button confirmok-mobilepopup-form'>"+n.confirmcontent.buttonoktext+"</a><a href='' class='button button-gray confirmno-mobilepopup-form'>"+n.confirmcontent.buttonnotext+"</a></div>"),a.removeClass("loading"),n.onloaded(a)}},h=function(){popupouter.css({"max-width":l.innerWidth()-20+"px","max-height":l.innerHeight()-20+"px"})},b=function(){popupoverflow.on("click",function(){return n.closeonoverflowclick?s.close():n.shakeonoverflowclick&&!popupouter.hasClass("shake-popup")&&(popupouter.addClass("shake-popup"),clearTimeout(c),c=setTimeout(function(){popupouter.removeClass("shake-popup")},500)),!1}),a.on("click",".close,.confirmno-mobilepopup-form",function(){return s.close(),!1}),a.on("click",".confirmok-mobilepopup-form",function(){return n.onconfirmed(a),s.close(),!1}),a.on("click",n.submitformbutton,function(){var t=a.find(n.popupform);return t.length>0&&(a.addClass("loading"),o.post(t.attr("action")+"?"+t.serialize(),function(o){n.onformsubmited(o,a),a.removeClass("loading")})),!1}),l.on("orientationchange resize",function(){h()})};o.mobilepopup=function(t,n){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void o.error("Method "+t+" not found for mobilepopup"):s.init.apply(this,arguments)}}(jQuery);